artists_sql = SELECT a.*, genres FROM (select artist_id, LTRIM(MAX(SYS_CONNECT_BY_PATH(name,',')) KEEP (DENSE_RANK LAST ORDER BY curr),',') AS genres FROM (SELECT artist_id, name, ROW_NUMBER() OVER (PARTITION BY artist_id ORDER BY name) AS curr, ROW_NUMBER() OVER (PARTITION BY artist_id ORDER BY name) -1 AS prev FROM (SELECT * FROM GENRE g JOIN artist_genre ag on ag.genre_id = g.id)) GROUP BY artist_id CONNECT BY prev = PRIOR curr AND artist_id = PRIOR artist_id START WITH curr = 1) t JOIN artist a on a.id = t.artist_id
events_sql = SELECT e.id AS event_id, e.name AS event_name, e.start_time, e.end_time, b.id AS billing_id, b.artist_id AS artist_id, b.lineup_order, v.id AS venue_id, v.name AS venue_name, t.id AS tour_id, t.name AS tour_name, sp.id AS seating_plan_id, sp.name AS seating_plan_name FROM event e JOIN seating_plan sp ON e.seating_plan_id = sp.id JOIN venue v ON sp.venue_id = v.id JOIN billing b ON b.event_id = e.id left outer JOIN tour t ON b.tour_id = t.id
login_sql = SELECT c.id as customer_id, c.title, c.forename, c.surname, c.telephone, c.mobile, c.line_1, c.line_2, c.town, c.county, c.postcode, c.country, c.thumb_image, c.created, l.id as login_id, l.email, l.token, l.registration_hash, p.name as permission FROM login l  LEFT OUTER JOIN login_permission lp ON lp.login_id = l.id LEFT OUTER JOIN permission p on lp.permission_id = p.id LEFT JOIN customer c ON c.login_id = l.id WHERE l.email = ? AND l.token = ?
account_sql = SELECT c.id as customer_id, c.title, c.forename, c.surname, c.telephone, c.mobile, c.line_1, c.line_2, c.town, c.county, c.postcode, c.country, c.thumb_image, c.created, l.id as login_id, l.email, l.token, l.registration_hash FROM login l LEFT JOIN customer c on c.login_id = l.id WHERE l.id = ?
favourites_sql = SELECT * FROM favorite WHERE customer_id = ?
insert_account_sql = INSERT INTO account (email, token, registration_hash) VALUES (?, ?, ?)
insert_customer_sql = INSERT INTO customer (title, forename, surname, telephone, mobile, line1, line2, town, county, postcode, country, thumb_image, created, account_id as login_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
insert_favourites_sql = INSERT INTO favorite (customer_id, artist_id, event_id, genre_id, venue_id) VALUES (?, ?, ?, ?, ?)
update_account_sql = UPDATE login l SET l.email = ?, l.token = ? WHERE l.id = ?
update_customer_sql = UPDATE customer c SET c.title = ?, c.forename = ?, c.surname = ?, c.telephone = ?, c.mobile = ?, c.line_1 = ?, c.line_2 = ?, c.town = ?, c.county = ?, c.postcode = ?, c.country = ?, c.thumb_image = ? WHERE c.login_id = ?
delete_favourites_sql = DELETE FROM favourite WHERE customer_id = ? AND id = ?
country_sql = SELECT * FROM country
title_sql = SELECT * FROM title